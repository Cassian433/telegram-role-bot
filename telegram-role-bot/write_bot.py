import base64, pathlib
b = "aW1wb3J0IGpzb24KaW1wb3J0IG9zCmltcG9ydCBsb2dnaW5nCmltcG9ydCB0cmFjZWJhY2sKZnJvbSB0ZWxlZ3JhbSBpbXBvcnQgVXBkYXRlCmZyb20gdGVsZWdyYW0uZXh0IGltcG9ydCBBcHBsaWNhdGlvbiwgQ29tbWFuZEhhbmRsZXIsIENvbnRleHRUeXBlcwpmcm9tIHRlbGVncmFtLmNvbnN0YW50cyBpbXBvcnQgUGFyc2VNb2RlCgojIC0tLSBDb25maWcgLS0tClRPS0VOID0gIjg0NTc3NDcwNDg6QUFGd2lQQ1IyNzRUZzlVS3ZBOVNraWFsNk1UZnctSlh4Z2MiCkRBVEFfRklMRSA9IG9zLnBhdGguam9pbihvcy5wYXRoLmRpcm5hbWUoX19maWxlX18pLCAicm9sZXNfZGF0YS5qc29uIikKCmxvZ2dpbmcuYmFzaWNDb25maWcoZm9ybWF0PSIlKGFzY3RpbWUpcyAtICUobmFtZSlzIC0gJShsZXZlbG5hbWUpcyAtICUobWVzc2FnZSlzIiwgbGV2ZWw9bG9nZ2luZy5JTkZPKQpsb2dnZXIgPSBsb2dnaW5nLmdldExvZ2dlcihfX25hbWVfXykKCiMgLS0tIERhdGEgaGVscGVycyAtLS0KZGVmIGxvYWRfZGF0YSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoREFUQV9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oREFUQV9GSUxFLCAiciIpIGFzIGY6CiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWQoZikKICAgIHJldHVybiB7fQoKZGVmIHNhdmVfZGF0YShkYXRhKToKICAgIHdpdGggb3BlbihEQVRBX0ZJTEUsICJ3IikgYXMgZjoKICAgICAgICBqc29uLmR1bXAoZGF0YSwgZiwgaW5kZW50PTIpCgpkZWYgZ2V0X2NoYXRfZGF0YShjaGF0X2lkOiBzdHIpOgogICAgZGF0YSA9IGxvYWRfZGF0YSgpCiAgICBpZiBjaGF0X2lkIG5vdCBpbiBkYXRhOgogICAgICAgIGRhdGFbY2hhdF9pZF0gPSB7InJvbGVzIjoge30sICJhc3NpZ25tZW50cyI6IHt9fQogICAgICAgIHNhdmVfZGF0YShkYXRhKQogICAgcmV0dXJuIGRhdGEsIGRhdGFbY2hhdF9pZF0KCiMgLS0tIFNhZmUgcmVwbHkgaGVscGVyIC0tLQphc3luYyBkZWYgcmVwbHkodXBkYXRlOiBVcGRhdGUsIHRleHQ6IHN0ciwgcGFyc2VfbW9kZT1Ob25lKToKICAgIGNoYXRfaWQgPSB1cGRhdGUuZWZmZWN0aXZlX2NoYXQuaWQKICAgIHRocmVhZF9pZCA9IGdldGF0dHIodXBkYXRlLm1lc3NhZ2UsICJtZXNzYWdlX3RocmVhZF9pZCIsIE5vbmUpCiAgICB0cnk6CiAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCh0ZXh0LCBwYXJzZV9tb2RlPXBhcnNlX21vZGUpCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHRyeToKICAgICAgICAgICAga3dhcmdzID0geyJjaGF0X2lkIjogY2hhdF9pZCwgInRleHQiOiB0ZXh0fQogICAgICAgICAgICBpZiBwYXJzZV9tb2RlOgogICAgICAgICAgICAgICAga3dhcmdzWyJwYXJzZV9tb2RlIl0gPSBwYXJzZV9tb2RlCiAgICAgICAgICAgIGlmIHRocmVhZF9pZDoKICAgICAgICAgICAgICAgIGt3YXJnc1sibWVzc2FnZV90aHJlYWRfaWQiXSA9IHRocmVhZF9pZAogICAgICAgICAgICBhd2FpdCB1cGRhdGUuZ2V0X2JvdCgpLnNlbmRfbWVzc2FnZSgqKmt3YXJncykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGUuZ2V0X2JvdCgpLnNlbmRfbWVzc2FnZShjaGF0X2lkPWNoYXRfaWQsIHRleHQ9dGV4dCkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRmFpbGVkIHRvIHNlbmQgbWVzc2FnZSB0byB7Y2hhdF9pZH06IHtlfSIpCgphc3luYyBkZWYgY2hlY2tfYWRtaW4odXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpIC0+IGJvb2w6CiAgICBpZiB1cGRhdGUuZWZmZWN0aXZlX2NoYXQudHlwZSA9PSAicHJpdmF0ZSI6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHRyeToKICAgICAgICBtZW1iZXIgPSBhd2FpdCBjb250ZXh0LmJvdC5nZXRfY2hhdF9tZW1iZXIodXBkYXRlLmVmZmVjdGl2ZV9jaGF0LmlkLCB1cGRhdGUuZWZmZWN0aXZlX3VzZXIuaWQpCiAgICAgICAgcmV0dXJuIG1lbWJlci5zdGF0dXMgaW4gKCJhZG1pbmlzdHJhdG9yIiwgImNyZWF0b3IiKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkFkbWluIGNoZWNrIGZhaWxlZDoge2V9IikKICAgICAgICByZXR1cm4gRmFsc2UKCmFzeW5jIGRlZiBlcnJvcl9oYW5kbGVyKHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgIGxvZ2dlci5lcnJvcihmIkV4Y2VwdGlvbiB3aGlsZSBoYW5kbGluZyB1cGRhdGU6IHtjb250ZXh0LmVycm9yfSIpCiAgICBsb2dnZXIuZXJyb3IodHJhY2ViYWNrLmZvcm1hdF9leGMoKSkKCmFzeW5jIGRlZiBzdGFydCh1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSk6CiAgICBhd2FpdCByZXBseSh1cGRhdGUsCiAgICAgICAgIlJvbGUgQm90IOKAlCBNYW5hZ2Ugcm9sZXMgaW4geW91ciBncm91cC5cblxuIgogICAgICAgICJBZG1pbiBjb21tYW5kczpcbiIKICAgICAgICAiICAvY3JlYXRlcm9sZSA8bmFtZT5cbiIKICAgICAgICAiICAvZGVsZXRlcm9sZSA8bmFtZT5cbiIKICAgICAgICAiICAvYXNzaWduIDxyb2xlPiA8QHVzZXIxIEB1c2VyMi4uLj5cbiIKICAgICAgICAiICAvdW5hc3NpZ24gPHJvbGU+IDxAdXNlciBvciByZXBseT5cblxuIgogICAgICAgICJFdmVyeW9uZTpcbiIKICAgICAgICAiICAvdGFnIDxyb2xlPiDigJQgVEFHIGV2ZXJ5b25lIHdpdGggYSByb2xlXG4iCiAgICAgICAgIiAgL3JvbGVzIOKAlCBMaXN0IGFsbCByb2xlc1xuIgogICAgICAgICIgIC9teXJvbGVzIOKAlCBTZWUgeW91ciByb2xlcyIKICAgICkKCmFzeW5jIGRlZiBjcmVhdGVyb2xlKHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgIGlmIG5vdCBhd2FpdCBjaGVja19hZG1pbih1cGRhdGUsIGNvbnRleHQpOgogICAgICAgIHJldHVybiBhd2FpdCByZXBseSh1cGRhdGUsICJPbmx5IGFkbWlucyBjYW4gY3JlYXRlIHJvbGVzLiIpCiAgICBpZiBub3QgY29udGV4dC5hcmdzOgogICAgICAgIHJldHVybiBhd2FpdCByZXBseSh1cGRhdGUsICJVc2FnZTogL2NyZWF0ZXJvbGUgPG5hbWU+IikKICAgIHJvbGVfbmFtZSA9ICIgIi5qb2luKGNvbnRleHQuYXJncykuc3RyaXAoKS5sb3dlcigpCiAgICBjaGF0X2lkID0gc3RyKHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZCkKICAgIGRhdGEsIGNoYXQgPSBnZXRfY2hhdF9kYXRhKGNoYXRfaWQpCiAgICBpZiByb2xlX25hbWUgaW4gY2hhdFsicm9sZXMiXToKICAgICAgICByZXR1cm4gYXdhaXQgcmVwbHkodXBkYXRlLCBmIlJvbGUgJ3tyb2xlX25hbWV9JyBhbHJlYWR5IGV4aXN0cy4iKQogICAgY2hhdFsicm9sZXMiXVtyb2xlX25hbWVdID0gVHJ1ZQogICAgc2F2ZV9kYXRhKGRhdGEpCiAgICBhd2FpdCByZXBseSh1cGRhdGUsIGYiUm9sZSAne3JvbGVfbmFtZX0nIGNyZWF0ZWQuIikKCmFzeW5jIGRlZiBkZWxldGVyb2xlKHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgIGlmIG5vdCBhd2FpdCBjaGVja19hZG1pbih1cGRhdGUsIGNvbnRleHQpOgogICAgICAgIHJldHVybiBhd2FpdCByZXBseSh1cGRhdGUsICJPbmx5IGFkbWlucyBjYW4gZGVsZXRlIHJvbGVzLiIpCiAgICBpZiBub3QgY29udGV4dC5hcmdzOgogICAgICAgIHJldHVybiBhd2FpdCByZXBseSh1cGRhdGUsICJVc2FnZTogL2RlbGV0ZXJvbGUgPG5hbWU+IikKICAgIHJvbGVfbmFtZSA9ICIgIi5qb2luKGNvbnRleHQuYXJncykuc3RyaXAoKS5sb3dlcigpCiAgICBjaGF0X2lkID0gc3RyKHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZCkKICAgIGRhdGEsIGNoYXQgPSBnZXRfY2hhdF9kYXRhKGNoYXRfaWQpCiAgICBpZiByb2xlX25hbWUgbm90IGluIGNoYXRbInJvbGVzIl06CiAgICAgICAgcmV0dXJuIGF3YWl0IHJlcGx5KHVwZGF0ZSwgZiJSb2xlICd7cm9sZV9uYW1lfScgZG9lc24ndCBleGlzdC4iKQogICAgZGVsIGNoYXRbInJvbGVzIl1bcm9sZV9uYW1lXQogICAgZm9yIHVpZCBpbiBsaXN0KGNoYXRbImFzc2lnbm1lbnRzIl0pOgogICAgICAgIGlmIHJvbGVfbmFtZSBpbiBjaGF0WyJhc3NpZ25tZW50cyJdW3VpZF06CiAgICAgICAgICAgIGNoYXRbImFzc2lnbm1lbnRzIl1bdWlkXS5yZW1vdmUocm9sZV9uYW1lKQogICAgc2F2ZV9kYXRhKGRhdGEpCiAgICBhd2FpdCByZXBseSh1cGRhdGUsIGYiUm9sZSAne3JvbGVfbmFtZX0nIGRlbGV0ZWQuIik="""